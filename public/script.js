const a=document.getElementById('audio'),l=document.getElementById('lyrics'),g=document.getElementById('generate'),p=document.getElementById('progress'),v=document.getElementById('preview');g.addEventListener('click',async()=>{if(!a.files[0]||!l.files[0]){alert('Bitte MP3 und LRC wÃ¤hlen');return;}const d=new FormData();d.append('audio',a.files[0]);d.append('lyrics',l.files[0]);g.disabled=true;p.style.display='block';p.value=10;try{const r=await fetch('/api/generate',{method:'POST',body:d});if(!r.ok)throw new Error();p.value=70;const b=await r.blob();p.value=90;v.src=URL.createObjectURL(b);v.style.display='block';p.value=100;}catch(e){alert('Fehler bei der Videoerstellung');}finally{g.disabled=false;setTimeout(()=>{p.style.display='none';p.value=0;},3000);}});